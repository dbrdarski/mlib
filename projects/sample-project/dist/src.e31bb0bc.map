{"version":3,"sources":["../../../src/Utils/index.js","../../../src/Router/index.js","../../../src/State/index.js","../../../src/Container/once.js","../../../src/Container/create-instance.js","../../../src/Container/create-store.js","../../../src/Container/index.js","../../../src/index.js","../node_modules/mithril/mithril.js","../node_modules/symbol-observable/es/ponyfill.js","../node_modules/symbol-observable/es/index.js","../node_modules/redux/es/redux.js","index.js"],"names":["isPrimitive","val","Object","isObject","copyObject","o","assign","constructor","objectMap","object","mapFn","keys","reduce","result","key","Request","path","segment","routes","params","match","matchedSegment","replace","value","defineProperty","route","freeze","route2regex","pattern","isGroup","regex","length","RegExp","join","map","p","slice","r","args","content","pop","options","Array","isArray","matchRoutes","i","processParams","req","hasParams","matchedParams","forEach","addParam","resolve","onmatch","push","children","updateSegment","nested","Promise","all","then","reject","createState","state","listeners","set","newState","x","get","subscribe","fn","unsubscribe","filter","history","pushState","onpushstate","apply","arguments","window","Router","notFound","onMatch","on404","routerState","router","getRoute","component","location","pathname","catch","onpopstate","name","module","exports","require","CreateState","concat","l","handler","observer","CreateProxy","record","parent","property","Proxy","target","prop","deleteProperty","once","createInstance","container","values","create","writable","type","deps","getDeps","instance","deep","console","log","caller","reduceFn","acc","dep","stack","parentName","depName","stackNames","createStore","settings","store","modules","storeKeys","storeGetter","plural","$scope","storeSetter","moduleName","bind","hasDep","circular","getter","str","Error","enumberable","defineProperties","define","entries","run","function","mainModule","scope","Utils","State","Container","symbolObservablePonyfill","root","Symbol","observable","self","global","Function","randomString","Math","random","toString","substring","split","ActionTypes","INIT","REPLACE","PROBE_UNKNOWN_ACTION","isPlainObject","obj","proto","getPrototypeOf","reducer","preloadedState","enhancer","_ref2","undefined","currentReducer","currentState","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","getState","listener","isSubscribed","index","indexOf","splice","dispatch","action","replaceReducer","nextReducer","_ref","outerSubscribe","TypeError","observeState","next","$$observable","warning","message","error","e","getUndefinedStateErrorMessage","actionType","actionDescription","String","getUnexpectedStateShapeWarningMessage","inputState","reducers","unexpectedKeyCache","reducerKeys","argumentName","call","unexpectedKeys","hasOwnProperty","assertReducerShape","initialState","combineReducers","finalReducers","finalReducerKeys","shapeAssertionError","combination","warningMessage","hasChanged","nextState","_i","_key","previousStateForKey","nextStateForKey","errorMessage","bindActionCreator","actionCreator","bindActionCreators","actionCreators","boundActionCreators","_defineProperty","enumerable","configurable","_objectSpread","source","ownKeys","getOwnPropertySymbols","sym","getOwnPropertyDescriptor","compose","_len","funcs","arg","a","b","applyMiddleware","middlewares","_dispatch","middlewareAPI","chain","middleware","isCrushed","mlib","Redux","counter","Link","view","attrs","to","onclick","href","preventDefault","R","users","dane","nom","sayHi","Template","vnode","UserList","NotFound","Hello","id","Counter","res","rej","setTimeout","App","render","m","document","body"],"mappings":"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IAAAA,WAAW,EAAE;AACXhB,MAAAA,QAAQ,EAAE,KADC;AAEX1F,MAAAA,KAAK,EAAE0G,WAAW,CAACnB,SAAD;AAFP;AAzBqD,GAAnC,CAAD,EA6B5B;AACFnB,IAAAA,IAAI,EAAE,KADJ;AAEFuB,IAAAA,IAAI,EAAE;AAFJ,GA7B4B,CAAhC;AAiCD,CAlCD,CAkCE,EAlCF,CADF;;AAsCAJ,SAAS,CAACmB,WAAV,CAAsB,QAAtB;AACArC,MAAM,CAACC,OAAP,GAAiBiB,SAAjB;;AC1CAlB,MAAM,CAACC,OAAP,GAAiB;AACf4D,EAAAA,KAAK,EAAE3D,OAAO,CAAC,SAAD,CADC;AAEff,EAAAA,MAAM,EAAEe,OAAO,CAAC,UAAD,CAFA;AAGf4D,EAAAA,KAAK,EAAE5D,OAAO,CAAC,SAAD,CAHC;AAIf6D,EAAAA,SAAS,EAAE7D,OAAO,CAAC,aAAD;AAJH,CAAjB;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACxuCe,SAAS8D,wBAAT,CAAkCC,IAAlC,EAAwC;AACtD,MAAIhJ,MAAJ;AACA,MAAIiJ,MAAM,GAAGD,IAAI,CAACC,MAAlB;;AAEA,MAAI,OAAOA,MAAP,KAAkB,UAAtB,EAAkC;AACjC,QAAIA,MAAM,CAACC,UAAX,EAAuB;AACtBlJ,MAAAA,MAAM,GAAGiJ,MAAM,CAACC,UAAhB;AACA,KAFD,MAEO;AACNlJ,MAAAA,MAAM,GAAGiJ,MAAM,CAAC,YAAD,CAAf;AACAA,MAAAA,MAAM,CAACC,UAAP,GAAoBlJ,MAApB;AACA;AACD,GAPD,MAOO;AACNA,IAAAA,MAAM,GAAG,cAAT;AACA;;AAED,SAAOA,MAAP;AACA;;AAAA;;;;;;;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","file":"src.e31bb0bc.map","sourceRoot":"..\\src","sourcesContent":["export const isPrimitive = (val) => Object(val) !== val;\r\nexport const isObject = (val) => Object(val) === val;\r\nexport const copyObject = (o) => Object.assign(o.constructor(), o );\r\nexport const objectMap = (object, mapFn) => Object.keys(object).reduce(\r\n  (result, key) => {\r\n    result[key] = mapFn(object[key], key, object)\r\n    return result\r\n  }, {}\r\n);\r\n","class Request{\n  constructor(path){\n    this.path = path;\n    this.segment = path;\n    this.routes = [];\n    this.params = {};\n    this.match = false;\n  }\n  // get segment(){\n  //   return !this.routes.length\n  //     ? this.path\n  //     : this.routes.path\n  // }\n  updateSegment(matchedSegment){\n    this.segment = this.segment.replace(matchedSegment, \"\")\n    return this;\n  }\n  addParam(key, value){\n    Object.defineProperty(this.params, key, { value });\n    return this;\n  }\n  resolve(route){\n    this.match = route;\n    Object.freeze(this);\n    return this;\n  }\n}\nconst route2regex = (pattern, isGroup) => {\n    let regex;\n    if (pattern === \"/\"){\n      pattern = '';\n    }\n    const params = pattern.match(/:[\\w][\\w\\d]*/g)\n    if(params && params.length){\n       regex = pattern.replace(\n         RegExp(params.join(\"|\"), 'g'),\n         \"([^/#?]+)\"\n       )\n    } else {\n        regex = pattern\n    }\n  return {\n    params: params && params.map(p => p.slice(1)),\n    regex: RegExp(`^${regex}${isGroup?'':'$'}`)\n  }\n}\n\nconst r = function(...args){\n  const content = args.pop();\n  const [ route, options ] = args;\n  const isGroup = Array.isArray(content);\n  const { params, regex } = route2regex(route, isGroup)\n  return {\n    route,\n    options,\n    [isGroup ? 'children':'component']: content,\n    regex,\n    params\n  }\n};\nconst matchRoutes = (routes, segment) => {\n  let match, route;\n  for ( let i = 0; i < routes.length; i++) {\n    route = routes[i];\n    match = segment.match(route.regex);\n    if(match){\n      return {route, result: match};\n    }\n  }\n  return false;\n}\nconst processParams = (match, req) => {\n  const hasParams = match.result.length > 1;\n  let matchedParams;\n  if(hasParams){\n    match.result.slice(1).forEach((value, key) => {\n      req.addParam(match.route.params[key], value)\n    })\n  }\n  return matchedParams;\n}\nconst resolve = (routes, req) => {\n  const match = matchRoutes(routes, req.segment);\n  if(match) {\n    processParams(match, req);\n    let onmatch = match.route.options && match.route.options.onmatch;\n    onmatch = onmatch && onmatch();\n    req.routes.push(match.route);\n    if (match.route.children) {\n      req.updateSegment(match.route.regex);\n      const nested = resolve(match.route.children, req);\n      return Promise.all([nested, onmatch]).then(([req]) => req)\n    } else {\n      return Promise.resolve(req.resolve(match.route));\n    }\n  }\n  return Promise.reject(req.resolve(false));\n}\nconst createState = (state, { listeners = [] } = {}) => ({\n  set: (newState) => {\n    state = newState;\n    listeners.forEach((x) => x());\n  },\n  get: () => state,\n  subscribe: (fn) => {\n    listeners = [...listeners, fn];\n    return function unsubscribe(){\n      listeners = listeners.filter( i => i !== fn)\n    };\n  }\n});\n\n(function(history){\n  var pushState = history.pushState;\n  history.pushState = function(...args) {\n      if (typeof history.onpushstate == \"function\") {\n          history.onpushstate(...args);\n      }\n      // ... whatever else you want to do\n      // maybe call onhashchange e.handler\n      return pushState.apply(history, arguments);\n  };\n})(window.history);\n\nconst Router = (routes, notFound = \"Not found.\", { onMatch, on404 } = {}) => {\n  let routerState = createState({});\n  const router = {\n    subscribe: routerState.subscribe,\n    getRoute: () => {\n      const state = routerState.get();\n      return {\n        path: state.path,\n        component: state.match && state.match.component,\n        params: state.params\n      };\n    },\n    // go: (url, options) => {\n    //   window.history.pushState({}, '', url);\n    // },\n    match: (path) => {\n      routerState.get().path !== path && resolve(routes, new Request(path))\n        .then((req) => {\n          routerState.set(req);\n          onMatch && onMatch()\n          window.location.pathname !== req.path && window.history.pushState({}, '', req.path);\n        })\n        .catch(\n          ({match, path}) => {\n            routerState.set({\n              path,\n              match: {\n                component: notFound\n              }\n            });\n          }\n        )\n      ;\n    }\n  }\n  window.onpopstate = history.onpushstate = (state, name, path) => router.match(path);\n  router.match(window.location.pathname);\n  return router;\n}\nmodule.exports = { r, Router }\n","const { isPrimitive, copyObject } = require('../Utils');\r\nvar CreateState = (state = {}) => {\r\n\tlet listeners = [];\r\n\tconst subscribe = (fn) => { listeners = listeners.concat(fn) };\r\n\tconst unsubscribe = (fn) => { listeners = listeners.filter(l => l != fn) };\r\n\tconst handler = ( state ) => { listeners = listeners.map(() => ({state}) ) };\r\n\tconst observer = CreateProxy(state, {handler});\r\n\r\n\treturn {\r\n\t\tstate: observer,\r\n\t\tsubscribe,\r\n\t\tunsubscribe\r\n\t};\r\n}\r\n\r\nvar CreateProxy = (record, { parent, property, handler } = {}) => {\r\n\treturn new Proxy(record, {\r\n\t\tget: (target, prop, parent) => {\r\n\t\t\tvar p = record[prop];\r\n\t\t\treturn isPrimitive(p)\r\n\t\t\t\t? p\r\n\t\t\t\t: CreateProxy(p, {\r\n\t\t\t\t\tparent,\r\n\t\t\t\t\tproperty: prop\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tdeleteProperty: (target, prop) => {\r\n\t\t\trecord = copyObject(record);\r\n\t\t\tdelete record[prop];\r\n\t\t\tif (parent != null){\r\n\t\t\t\tparent[property] = record;\r\n\t\t\t}\r\n\t\t},\r\n\t\tset: (target, prop, value) => {\r\n\t\t\trecord = copyObject(record);\r\n\t\t\trecord[prop] = value;\r\n\t\t\tif (parent != null){\r\n\t\t\t\tparent[property] = record;\r\n\t\t\t}\r\n\t\t\thandler && handler(record);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nmodule.exports = {\r\n\tCreateState,\r\n\tCreateProxy\r\n}\r\n","var once = function(fn){\r\n  var resolve;\r\n  return function(){    \r\n    if (resolve == null){\r\n      resolve = fn.apply(this, arguments);\r\n    }\r\n    return resolve;\r\n  }\r\n}\r\n\r\nmodule.exports = once;\r\n","var createInstance = function(container, values) {\r\n  return Object.defineProperty(Object.create(container), '$scope', {\r\n    writable: false,\r\n    value: {\r\n      name: values.name,\r\n      type: values.type,\r\n      module: values.module,\r\n      deps: values.deps || [],\r\n      getDeps: function getDeps(module, instance, deep){\r\n        console.log('====GET DEPS====')\r\n        console.log({module, caller: instance})\r\n        return module.deps.reduce(function reduceFn(acc, dep){\r\n          console.log('====REDUCE DEPS====')\r\n          console.log({acc, dep})\r\n          var result = acc.match || acc.stack.reduce((acc, i) => {\r\n            console.log('====REDUCE STACK====')\r\n            console.log({match: acc, dep})\r\n            return acc || i.module === dep.module && i\r\n          }, false);\r\n          return result ? {\r\n            match: true,\r\n            parent: acc.parent,\r\n            parentName: acc.parent.name,\r\n            dep: result,\r\n            depName: result.name,\r\n            stack: acc.stack,\r\n            stackNames: acc.stack.map( x => x.name )\r\n          } : deep ?\r\n            dep.deps.reduce(reduceFn, {\r\n              match: false,\r\n              parent: dep,\r\n              parentName: dep.name,\r\n              stack: acc.stack.concat(dep),\r\n              stackNames: acc.stack.concat(dep).map( x => x.name )\r\n            }) : {match: false};\r\n        }, {\r\n          match: false,\r\n          stack: [instance],\r\n          stackNames: [instance.name],\r\n          parent: instance,\r\n          parentName: instance.name\r\n        })\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = createInstance;\r\n","var once = require('./once');\r\nvar createInstance = require('./create-instance');\r\n\r\nvar createStore = function(container){\r\n  return function(name, settings){\r\n    var store = Object.defineProperty({}, '$resolve', {\r\n      writable: false,\r\n      value: function(){\r\n        var modules = arguments.length ? arguments : Object.keys(store);\r\n        modules.forEach(function(key){\r\n          store[key];\r\n        });\r\n      }\r\n    });\r\n    var storeKeys = {};\r\n    var storeGetter = storeKeys[settings && settings.plural || (name + 's')] = {get: function(){ return createInstance(store, this.$scope)}};\r\n    var storeSetter = storeKeys[name] = {\r\n      value: function(moduleName, module){\r\n        var instance = createInstance(container, {\r\n          name: moduleName,\r\n          type: name,\r\n          module: module\r\n        });\r\n        var resolve = once(module.bind(null, instance))\r\n        Object.defineProperty(store, moduleName, {\r\n          get: function(){\r\n            console.log('====GETTER====')\r\n            console.log(moduleName)\r\n            console.log(\"Deps for \" + this.$scope.name+ ', checked by ' + instance.$scope.name + ', non-recursive (shallow)!')\r\n            var hasDep = this.$scope.getDeps(this.$scope, instance.$scope)\r\n            console.log('====HAS DEP====')\r\n            console.log({hasDep});\r\n            console.log('====ADD DEP====')\r\n            console.log(this.$scope.name + ' gets ' + instance.$scope.name);\r\n            hasDep && hasDep.match || this.$scope.deps.push(instance.$scope);\r\n\r\n            console.log(\"Deps for \" + instance.$scope.name+ ', checked by ' + this.$scope.name + ', deep recursive!')\r\n            var circular = instance.$scope.getDeps(instance.$scope, this.$scope, true);\r\n            console.log('====IS CIRCULAR?====')\r\n            console.log({\r\n              circular: circular,\r\n              caller: this.$scope,\r\n              getter: instance.$scope\r\n            });\r\n            if (circular && circular.match) {\r\n              console.log('====IS CIRCULAR?====')\r\n              circular = instance.$scope.getDeps(instance.$scope, this.$scope, true);\r\n              console.log({...circular, str: circular.stack.map((x) => x.type+': '+x.name).join('=>')})\r\n              throw new Error([\"You have circular dependency between\",circular.dep.type,\"'\"+circular.dep.name+\"'\",'and',circular.parent.type,\"'\"+circular.parent.name+\"'\"].join(\" \"))\r\n            }\r\n            return resolve();\r\n          },\r\n          enumberable: true\r\n        })\r\n        return container;\r\n      }\r\n    };\r\n    Object.defineProperties(container, storeKeys)\r\n  }\r\n}\r\n\r\nmodule.exports = createStore;\r\n","var createStore = require('./create-store');\r\nvar createInstance = require('./create-instance');\r\n\r\nvar container = (\r\n  function(container, instance){\r\n    return instance = createInstance(Object.defineProperties(container, {\r\n      define: {\r\n        writable: false,\r\n        value: function(name, value){\r\n          if(value == null && typeof name === 'object'){\r\n            Object.defineProperties(container, Object.entries(name).reduce(function(acc, i){\r\n              acc[i[0]] = { value: acc[i[1]], writable: false };\r\n              return acc;\r\n            }, {}));\r\n          } else {\r\n            Object.defineProperty(container, name, {value, writable: false})\r\n            return container;\r\n          }\r\n        }\r\n      },\r\n      run: {\r\n        writable: false,\r\n        value: {\r\n          function(mainModule){\r\n            scope.module = mainModule;\r\n            mainModule(instance);\r\n            return container;\r\n          }\r\n        }\r\n      },\r\n      createStore: {\r\n        writable: false,\r\n        value: createStore(container)\r\n      }\r\n    }), {\r\n      name: 'app',\r\n      type: 'container'\r\n    });\r\n  }({})\r\n);\r\n\r\ncontainer.createStore('module');\r\nmodule.exports = container;\r\n","module.exports = {\r\n  Utils: require('./Utils'),\r\n  Router: require('./Router'),\r\n  State: require('./State'),\r\n  Container: require('./Container')\r\n}\r\n",";(function() {\n\"use strict\"\nfunction Vnode(tag, key, attrs0, children, text, dom) {\n\treturn {tag: tag, key: key, attrs: attrs0, children: children, text: text, dom: dom, domSize: undefined, state: undefined, _state: undefined, events: undefined, instance: undefined, skip: false}\n}\nVnode.normalize = function(node) {\n\tif (Array.isArray(node)) return Vnode(\"[\", undefined, undefined, Vnode.normalizeChildren(node), undefined, undefined)\n\tif (node != null && typeof node !== \"object\") return Vnode(\"#\", undefined, undefined, node === false ? \"\" : node, undefined, undefined)\n\treturn node\n}\nVnode.normalizeChildren = function normalizeChildren(children) {\n\tfor (var i = 0; i < children.length; i++) {\n\t\tchildren[i] = Vnode.normalize(children[i])\n\t}\n\treturn children\n}\nvar selectorParser = /(?:(^|#|\\.)([^#\\.\\[\\]]+))|(\\[(.+?)(?:\\s*=\\s*(\"|'|)((?:\\\\[\"'\\]]|.)*?)\\5)?\\])/g\nvar selectorCache = {}\nvar hasOwn = {}.hasOwnProperty\nfunction isEmpty(object) {\n\tfor (var key in object) if (hasOwn.call(object, key)) return false\n\treturn true\n}\nfunction compileSelector(selector) {\n\tvar match, tag = \"div\", classes = [], attrs = {}\n\twhile (match = selectorParser.exec(selector)) {\n\t\tvar type = match[1], value = match[2]\n\t\tif (type === \"\" && value !== \"\") tag = value\n\t\telse if (type === \"#\") attrs.id = value\n\t\telse if (type === \".\") classes.push(value)\n\t\telse if (match[3][0] === \"[\") {\n\t\t\tvar attrValue = match[6]\n\t\t\tif (attrValue) attrValue = attrValue.replace(/\\\\([\"'])/g, \"$1\").replace(/\\\\\\\\/g, \"\\\\\")\n\t\t\tif (match[4] === \"class\") classes.push(attrValue)\n\t\t\telse attrs[match[4]] = attrValue === \"\" ? attrValue : attrValue || true\n\t\t}\n\t}\n\tif (classes.length > 0) attrs.className = classes.join(\" \")\n\treturn selectorCache[selector] = {tag: tag, attrs: attrs}\n}\nfunction execSelector(state, attrs, children) {\n\tvar hasAttrs = false, childList, text\n\tvar className = attrs.className || attrs.class\n\tif (!isEmpty(state.attrs) && !isEmpty(attrs)) {\n\t\tvar newAttrs = {}\n\t\tfor(var key in attrs) {\n\t\t\tif (hasOwn.call(attrs, key)) {\n\t\t\t\tnewAttrs[key] = attrs[key]\n\t\t\t}\n\t\t}\n\t\tattrs = newAttrs\n\t}\n\tfor (var key in state.attrs) {\n\t\tif (hasOwn.call(state.attrs, key)) {\n\t\t\tattrs[key] = state.attrs[key]\n\t\t}\n\t}\n\tif (className !== undefined) {\n\t\tif (attrs.class !== undefined) {\n\t\t\tattrs.class = undefined\n\t\t\tattrs.className = className\n\t\t}\n\t\tif (state.attrs.className != null) {\n\t\t\tattrs.className = state.attrs.className + \" \" + className\n\t\t}\n\t}\n\tfor (var key in attrs) {\n\t\tif (hasOwn.call(attrs, key) && key !== \"key\") {\n\t\t\thasAttrs = true\n\t\t\tbreak\n\t\t}\n\t}\n\tif (Array.isArray(children) && children.length === 1 && children[0] != null && children[0].tag === \"#\") {\n\t\ttext = children[0].children\n\t} else {\n\t\tchildList = children\n\t}\n\treturn Vnode(state.tag, attrs.key, hasAttrs ? attrs : undefined, childList, text)\n}\nfunction hyperscript(selector) {\n\t// Because sloppy mode sucks\n\tvar attrs = arguments[1], start = 2, children\n\tif (selector == null || typeof selector !== \"string\" && typeof selector !== \"function\" && typeof selector.view !== \"function\") {\n\t\tthrow Error(\"The selector must be either a string or a component.\");\n\t}\n\tif (typeof selector === \"string\") {\n\t\tvar cached = selectorCache[selector] || compileSelector(selector)\n\t}\n\tif (attrs == null) {\n\t\tattrs = {}\n\t} else if (typeof attrs !== \"object\" || attrs.tag != null || Array.isArray(attrs)) {\n\t\tattrs = {}\n\t\tstart = 1\n\t}\n\tif (arguments.length === start + 1) {\n\t\tchildren = arguments[start]\n\t\tif (!Array.isArray(children)) children = [children]\n\t} else {\n\t\tchildren = []\n\t\twhile (start < arguments.length) children.push(arguments[start++])\n\t}\n\tvar normalized = Vnode.normalizeChildren(children)\n\tif (typeof selector === \"string\") {\n\t\treturn execSelector(cached, attrs, normalized)\n\t} else {\n\t\treturn Vnode(selector, attrs.key, attrs, normalized)\n\t}\n}\nhyperscript.trust = function(html) {\n\tif (html == null) html = \"\"\n\treturn Vnode(\"<\", undefined, undefined, html, undefined, undefined)\n}\nhyperscript.fragment = function(attrs1, children) {\n\treturn Vnode(\"[\", attrs1.key, attrs1, Vnode.normalizeChildren(children), undefined, undefined)\n}\nvar m = hyperscript\n/** @constructor */\nvar PromisePolyfill = function(executor) {\n\tif (!(this instanceof PromisePolyfill)) throw new Error(\"Promise must be called with `new`\")\n\tif (typeof executor !== \"function\") throw new TypeError(\"executor must be a function\")\n\tvar self = this, resolvers = [], rejectors = [], resolveCurrent = handler(resolvers, true), rejectCurrent = handler(rejectors, false)\n\tvar instance = self._instance = {resolvers: resolvers, rejectors: rejectors}\n\tvar callAsync = typeof setImmediate === \"function\" ? setImmediate : setTimeout\n\tfunction handler(list, shouldAbsorb) {\n\t\treturn function execute(value) {\n\t\t\tvar then\n\t\t\ttry {\n\t\t\t\tif (shouldAbsorb && value != null && (typeof value === \"object\" || typeof value === \"function\") && typeof (then = value.then) === \"function\") {\n\t\t\t\t\tif (value === self) throw new TypeError(\"Promise can't be resolved w/ itself\")\n\t\t\t\t\texecuteOnce(then.bind(value))\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcallAsync(function() {\n\t\t\t\t\t\tif (!shouldAbsorb && list.length === 0) console.error(\"Possible unhandled promise rejection:\", value)\n\t\t\t\t\t\tfor (var i = 0; i < list.length; i++) list[i](value)\n\t\t\t\t\t\tresolvers.length = 0, rejectors.length = 0\n\t\t\t\t\t\tinstance.state = shouldAbsorb\n\t\t\t\t\t\tinstance.retry = function() {execute(value)}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\trejectCurrent(e)\n\t\t\t}\n\t\t}\n\t}\n\tfunction executeOnce(then) {\n\t\tvar runs = 0\n\t\tfunction run(fn) {\n\t\t\treturn function(value) {\n\t\t\t\tif (runs++ > 0) return\n\t\t\t\tfn(value)\n\t\t\t}\n\t\t}\n\t\tvar onerror = run(rejectCurrent)\n\t\ttry {then(run(resolveCurrent), onerror)} catch (e) {onerror(e)}\n\t}\n\texecuteOnce(executor)\n}\nPromisePolyfill.prototype.then = function(onFulfilled, onRejection) {\n\tvar self = this, instance = self._instance\n\tfunction handle(callback, list, next, state) {\n\t\tlist.push(function(value) {\n\t\t\tif (typeof callback !== \"function\") next(value)\n\t\t\telse try {resolveNext(callback(value))} catch (e) {if (rejectNext) rejectNext(e)}\n\t\t})\n\t\tif (typeof instance.retry === \"function\" && state === instance.state) instance.retry()\n\t}\n\tvar resolveNext, rejectNext\n\tvar promise = new PromisePolyfill(function(resolve, reject) {resolveNext = resolve, rejectNext = reject})\n\thandle(onFulfilled, instance.resolvers, resolveNext, true), handle(onRejection, instance.rejectors, rejectNext, false)\n\treturn promise\n}\nPromisePolyfill.prototype.catch = function(onRejection) {\n\treturn this.then(null, onRejection)\n}\nPromisePolyfill.resolve = function(value) {\n\tif (value instanceof PromisePolyfill) return value\n\treturn new PromisePolyfill(function(resolve) {resolve(value)})\n}\nPromisePolyfill.reject = function(value) {\n\treturn new PromisePolyfill(function(resolve, reject) {reject(value)})\n}\nPromisePolyfill.all = function(list) {\n\treturn new PromisePolyfill(function(resolve, reject) {\n\t\tvar total = list.length, count = 0, values = []\n\t\tif (list.length === 0) resolve([])\n\t\telse for (var i = 0; i < list.length; i++) {\n\t\t\t(function(i) {\n\t\t\t\tfunction consume(value) {\n\t\t\t\t\tcount++\n\t\t\t\t\tvalues[i] = value\n\t\t\t\t\tif (count === total) resolve(values)\n\t\t\t\t}\n\t\t\t\tif (list[i] != null && (typeof list[i] === \"object\" || typeof list[i] === \"function\") && typeof list[i].then === \"function\") {\n\t\t\t\t\tlist[i].then(consume, reject)\n\t\t\t\t}\n\t\t\t\telse consume(list[i])\n\t\t\t})(i)\n\t\t}\n\t})\n}\nPromisePolyfill.race = function(list) {\n\treturn new PromisePolyfill(function(resolve, reject) {\n\t\tfor (var i = 0; i < list.length; i++) {\n\t\t\tlist[i].then(resolve, reject)\n\t\t}\n\t})\n}\nif (typeof window !== \"undefined\") {\n\tif (typeof window.Promise === \"undefined\") window.Promise = PromisePolyfill\n\tvar PromisePolyfill = window.Promise\n} else if (typeof global !== \"undefined\") {\n\tif (typeof global.Promise === \"undefined\") global.Promise = PromisePolyfill\n\tvar PromisePolyfill = global.Promise\n} else {\n}\nvar buildQueryString = function(object) {\n\tif (Object.prototype.toString.call(object) !== \"[object Object]\") return \"\"\n\tvar args = []\n\tfor (var key0 in object) {\n\t\tdestructure(key0, object[key0])\n\t}\n\treturn args.join(\"&\")\n\tfunction destructure(key0, value) {\n\t\tif (Array.isArray(value)) {\n\t\t\tfor (var i = 0; i < value.length; i++) {\n\t\t\t\tdestructure(key0 + \"[\" + i + \"]\", value[i])\n\t\t\t}\n\t\t}\n\t\telse if (Object.prototype.toString.call(value) === \"[object Object]\") {\n\t\t\tfor (var i in value) {\n\t\t\t\tdestructure(key0 + \"[\" + i + \"]\", value[i])\n\t\t\t}\n\t\t}\n\t\telse args.push(encodeURIComponent(key0) + (value != null && value !== \"\" ? \"=\" + encodeURIComponent(value) : \"\"))\n\t}\n}\nvar FILE_PROTOCOL_REGEX = new RegExp(\"^file://\", \"i\")\nvar _8 = function($window, Promise) {\n\tvar callbackCount = 0\n\tvar oncompletion\n\tfunction setCompletionCallback(callback) {oncompletion = callback}\n\tfunction finalizer() {\n\t\tvar count = 0\n\t\tfunction complete() {if (--count === 0 && typeof oncompletion === \"function\") oncompletion()}\n\t\treturn function finalize(promise0) {\n\t\t\tvar then0 = promise0.then\n\t\t\tpromise0.then = function() {\n\t\t\t\tcount++\n\t\t\t\tvar next = then0.apply(promise0, arguments)\n\t\t\t\tnext.then(complete, function(e) {\n\t\t\t\t\tcomplete()\n\t\t\t\t\tif (count === 0) throw e\n\t\t\t\t})\n\t\t\t\treturn finalize(next)\n\t\t\t}\n\t\t\treturn promise0\n\t\t}\n\t}\n\tfunction normalize(args, extra) {\n\t\tif (typeof args === \"string\") {\n\t\t\tvar url = args\n\t\t\targs = extra || {}\n\t\t\tif (args.url == null) args.url = url\n\t\t}\n\t\treturn args\n\t}\n\tfunction request(args, extra) {\n\t\tvar finalize = finalizer()\n\t\targs = normalize(args, extra)\n\t\tvar promise0 = new Promise(function(resolve, reject) {\n\t\t\tif (args.method == null) args.method = \"GET\"\n\t\t\targs.method = args.method.toUpperCase()\n\t\t\tvar useBody = (args.method === \"GET\" || args.method === \"TRACE\") ? false : (typeof args.useBody === \"boolean\" ? args.useBody : true)\n\t\t\tif (typeof args.serialize !== \"function\") args.serialize = typeof FormData !== \"undefined\" && args.data instanceof FormData ? function(value) {return value} : JSON.stringify\n\t\t\tif (typeof args.deserialize !== \"function\") args.deserialize = deserialize\n\t\t\tif (typeof args.extract !== \"function\") args.extract = extract\n\t\t\targs.url = interpolate(args.url, args.data)\n\t\t\tif (useBody) args.data = args.serialize(args.data)\n\t\t\telse args.url = assemble(args.url, args.data)\n\t\t\tvar xhr = new $window.XMLHttpRequest(),\n\t\t\t\taborted = false,\n\t\t\t\t_abort = xhr.abort\n\t\t\txhr.abort = function abort() {\n\t\t\t\taborted = true\n\t\t\t\t_abort.call(xhr)\n\t\t\t}\n\t\t\txhr.open(args.method, args.url, typeof args.async === \"boolean\" ? args.async : true, typeof args.user === \"string\" ? args.user : undefined, typeof args.password === \"string\" ? args.password : undefined)\n\t\t\tif (args.serialize === JSON.stringify && useBody && !(args.headers && args.headers.hasOwnProperty(\"Content-Type\"))) {\n\t\t\t\txhr.setRequestHeader(\"Content-Type\", \"application/json; charset=utf-8\")\n\t\t\t}\n\t\t\tif (args.deserialize === deserialize && !(args.headers && args.headers.hasOwnProperty(\"Accept\"))) {\n\t\t\t\txhr.setRequestHeader(\"Accept\", \"application/json, text/*\")\n\t\t\t}\n\t\t\tif (args.withCredentials) xhr.withCredentials = args.withCredentials\n\t\t\tfor (var key in args.headers) if ({}.hasOwnProperty.call(args.headers, key)) {\n\t\t\t\txhr.setRequestHeader(key, args.headers[key])\n\t\t\t}\n\t\t\tif (typeof args.config === \"function\") xhr = args.config(xhr, args) || xhr\n\t\t\txhr.onreadystatechange = function() {\n\t\t\t\t// Don't throw errors on xhr.abort().\n\t\t\t\tif(aborted) return\n\t\t\t\tif (xhr.readyState === 4) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar response = (args.extract !== extract) ? args.extract(xhr, args) : args.deserialize(args.extract(xhr, args))\n\t\t\t\t\t\tif ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304 || FILE_PROTOCOL_REGEX.test(args.url)) {\n\t\t\t\t\t\t\tresolve(cast(args.type, response))\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar error = new Error(xhr.responseText)\n\t\t\t\t\t\t\tfor (var key in response) error[key] = response[key]\n\t\t\t\t\t\t\treject(error)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\treject(e)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (useBody && (args.data != null)) xhr.send(args.data)\n\t\t\telse xhr.send()\n\t\t})\n\t\treturn args.background === true ? promise0 : finalize(promise0)\n\t}\n\tfunction jsonp(args, extra) {\n\t\tvar finalize = finalizer()\n\t\targs = normalize(args, extra)\n\t\tvar promise0 = new Promise(function(resolve, reject) {\n\t\t\tvar callbackName = args.callbackName || \"_mithril_\" + Math.round(Math.random() * 1e16) + \"_\" + callbackCount++\n\t\t\tvar script = $window.document.createElement(\"script\")\n\t\t\t$window[callbackName] = function(data) {\n\t\t\t\tscript.parentNode.removeChild(script)\n\t\t\t\tresolve(cast(args.type, data))\n\t\t\t\tdelete $window[callbackName]\n\t\t\t}\n\t\t\tscript.onerror = function() {\n\t\t\t\tscript.parentNode.removeChild(script)\n\t\t\t\treject(new Error(\"JSONP request failed\"))\n\t\t\t\tdelete $window[callbackName]\n\t\t\t}\n\t\t\tif (args.data == null) args.data = {}\n\t\t\targs.url = interpolate(args.url, args.data)\n\t\t\targs.data[args.callbackKey || \"callback\"] = callbackName\n\t\t\tscript.src = assemble(args.url, args.data)\n\t\t\t$window.document.documentElement.appendChild(script)\n\t\t})\n\t\treturn args.background === true? promise0 : finalize(promise0)\n\t}\n\tfunction interpolate(url, data) {\n\t\tif (data == null) return url\n\t\tvar tokens = url.match(/:[^\\/]+/gi) || []\n\t\tfor (var i = 0; i < tokens.length; i++) {\n\t\t\tvar key = tokens[i].slice(1)\n\t\t\tif (data[key] != null) {\n\t\t\t\turl = url.replace(tokens[i], data[key])\n\t\t\t}\n\t\t}\n\t\treturn url\n\t}\n\tfunction assemble(url, data) {\n\t\tvar querystring = buildQueryString(data)\n\t\tif (querystring !== \"\") {\n\t\t\tvar prefix = url.indexOf(\"?\") < 0 ? \"?\" : \"&\"\n\t\t\turl += prefix + querystring\n\t\t}\n\t\treturn url\n\t}\n\tfunction deserialize(data) {\n\t\ttry {return data !== \"\" ? JSON.parse(data) : null}\n\t\tcatch (e) {throw new Error(data)}\n\t}\n\tfunction extract(xhr) {return xhr.responseText}\n\tfunction cast(type0, data) {\n\t\tif (typeof type0 === \"function\") {\n\t\t\tif (Array.isArray(data)) {\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\tdata[i] = new type0(data[i])\n\t\t\t\t}\n\t\t\t}\n\t\t\telse return new type0(data)\n\t\t}\n\t\treturn data\n\t}\n\treturn {request: request, jsonp: jsonp, setCompletionCallback: setCompletionCallback}\n}\nvar requestService = _8(window, PromisePolyfill)\nvar coreRenderer = function($window) {\n\tvar $doc = $window.document\n\tvar $emptyFragment = $doc.createDocumentFragment()\n\tvar nameSpace = {\n\t\tsvg: \"http://www.w3.org/2000/svg\",\n\t\tmath: \"http://www.w3.org/1998/Math/MathML\"\n\t}\n\tvar onevent\n\tfunction setEventCallback(callback) {return onevent = callback}\n\tfunction getNameSpace(vnode) {\n\t\treturn vnode.attrs && vnode.attrs.xmlns || nameSpace[vnode.tag]\n\t}\n\t//create\n\tfunction createNodes(parent, vnodes, start, end, hooks, nextSibling, ns) {\n\t\tfor (var i = start; i < end; i++) {\n\t\t\tvar vnode = vnodes[i]\n\t\t\tif (vnode != null) {\n\t\t\t\tcreateNode(parent, vnode, hooks, ns, nextSibling)\n\t\t\t}\n\t\t}\n\t}\n\tfunction createNode(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar tag = vnode.tag\n\t\tif (typeof tag === \"string\") {\n\t\t\tvnode.state = {}\n\t\t\tif (vnode.attrs != null) initLifecycle(vnode.attrs, vnode, hooks)\n\t\t\tswitch (tag) {\n\t\t\t\tcase \"#\": return createText(parent, vnode, nextSibling)\n\t\t\t\tcase \"<\": return createHTML(parent, vnode, nextSibling)\n\t\t\t\tcase \"[\": return createFragment(parent, vnode, hooks, ns, nextSibling)\n\t\t\t\tdefault: return createElement(parent, vnode, hooks, ns, nextSibling)\n\t\t\t}\n\t\t}\n\t\telse return createComponent(parent, vnode, hooks, ns, nextSibling)\n\t}\n\tfunction createText(parent, vnode, nextSibling) {\n\t\tvnode.dom = $doc.createTextNode(vnode.children)\n\t\tinsertNode(parent, vnode.dom, nextSibling)\n\t\treturn vnode.dom\n\t}\n\tfunction createHTML(parent, vnode, nextSibling) {\n\t\tvar match1 = vnode.children.match(/^\\s*?<(\\w+)/im) || []\n\t\tvar parent1 = {caption: \"table\", thead: \"table\", tbody: \"table\", tfoot: \"table\", tr: \"tbody\", th: \"tr\", td: \"tr\", colgroup: \"table\", col: \"colgroup\"}[match1[1]] || \"div\"\n\t\tvar temp = $doc.createElement(parent1)\n\t\ttemp.innerHTML = vnode.children\n\t\tvnode.dom = temp.firstChild\n\t\tvnode.domSize = temp.childNodes.length\n\t\tvar fragment = $doc.createDocumentFragment()\n\t\tvar child\n\t\twhile (child = temp.firstChild) {\n\t\t\tfragment.appendChild(child)\n\t\t}\n\t\tinsertNode(parent, fragment, nextSibling)\n\t\treturn fragment\n\t}\n\tfunction createFragment(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar fragment = $doc.createDocumentFragment()\n\t\tif (vnode.children != null) {\n\t\t\tvar children = vnode.children\n\t\t\tcreateNodes(fragment, children, 0, children.length, hooks, null, ns)\n\t\t}\n\t\tvnode.dom = fragment.firstChild\n\t\tvnode.domSize = fragment.childNodes.length\n\t\tinsertNode(parent, fragment, nextSibling)\n\t\treturn fragment\n\t}\n\tfunction createElement(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar tag = vnode.tag\n\t\tvar attrs2 = vnode.attrs\n\t\tvar is = attrs2 && attrs2.is\n\t\tns = getNameSpace(vnode) || ns\n\t\tvar element = ns ?\n\t\t\tis ? $doc.createElementNS(ns, tag, {is: is}) : $doc.createElementNS(ns, tag) :\n\t\t\tis ? $doc.createElement(tag, {is: is}) : $doc.createElement(tag)\n\t\tvnode.dom = element\n\t\tif (attrs2 != null) {\n\t\t\tsetAttrs(vnode, attrs2, ns)\n\t\t}\n\t\tinsertNode(parent, element, nextSibling)\n\t\tif (vnode.attrs != null && vnode.attrs.contenteditable != null) {\n\t\t\tsetContentEditable(vnode)\n\t\t}\n\t\telse {\n\t\t\tif (vnode.text != null) {\n\t\t\t\tif (vnode.text !== \"\") element.textContent = vnode.text\n\t\t\t\telse vnode.children = [Vnode(\"#\", undefined, undefined, vnode.text, undefined, undefined)]\n\t\t\t}\n\t\t\tif (vnode.children != null) {\n\t\t\t\tvar children = vnode.children\n\t\t\t\tcreateNodes(element, children, 0, children.length, hooks, null, ns)\n\t\t\t\tsetLateAttrs(vnode)\n\t\t\t}\n\t\t}\n\t\treturn element\n\t}\n\tfunction initComponent(vnode, hooks) {\n\t\tvar sentinel\n\t\tif (typeof vnode.tag.view === \"function\") {\n\t\t\tvnode.state = Object.create(vnode.tag)\n\t\t\tsentinel = vnode.state.view\n\t\t\tif (sentinel.$$reentrantLock$$ != null) return $emptyFragment\n\t\t\tsentinel.$$reentrantLock$$ = true\n\t\t} else {\n\t\t\tvnode.state = void 0\n\t\t\tsentinel = vnode.tag\n\t\t\tif (sentinel.$$reentrantLock$$ != null) return $emptyFragment\n\t\t\tsentinel.$$reentrantLock$$ = true\n\t\t\tvnode.state = (vnode.tag.prototype != null && typeof vnode.tag.prototype.view === \"function\") ? new vnode.tag(vnode) : vnode.tag(vnode)\n\t\t}\n\t\tvnode._state = vnode.state\n\t\tif (vnode.attrs != null) initLifecycle(vnode.attrs, vnode, hooks)\n\t\tinitLifecycle(vnode._state, vnode, hooks)\n\t\tvnode.instance = Vnode.normalize(vnode._state.view.call(vnode.state, vnode))\n\t\tif (vnode.instance === vnode) throw Error(\"A view cannot return the vnode it received as argument\")\n\t\tsentinel.$$reentrantLock$$ = null\n\t}\n\tfunction createComponent(parent, vnode, hooks, ns, nextSibling) {\n\t\tinitComponent(vnode, hooks)\n\t\tif (vnode.instance != null) {\n\t\t\tvar element = createNode(parent, vnode.instance, hooks, ns, nextSibling)\n\t\t\tvnode.dom = vnode.instance.dom\n\t\t\tvnode.domSize = vnode.dom != null ? vnode.instance.domSize : 0\n\t\t\tinsertNode(parent, element, nextSibling)\n\t\t\treturn element\n\t\t}\n\t\telse {\n\t\t\tvnode.domSize = 0\n\t\t\treturn $emptyFragment\n\t\t}\n\t}\n\t//update\n\tfunction updateNodes(parent, old, vnodes, recycling, hooks, nextSibling, ns) {\n\t\tif (old === vnodes || old == null && vnodes == null) return\n\t\telse if (old == null) createNodes(parent, vnodes, 0, vnodes.length, hooks, nextSibling, ns)\n\t\telse if (vnodes == null) removeNodes(old, 0, old.length, vnodes)\n\t\telse {\n\t\t\tif (old.length === vnodes.length) {\n\t\t\t\tvar isUnkeyed = false\n\t\t\t\tfor (var i = 0; i < vnodes.length; i++) {\n\t\t\t\t\tif (vnodes[i] != null && old[i] != null) {\n\t\t\t\t\t\tisUnkeyed = vnodes[i].key == null && old[i].key == null\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (isUnkeyed) {\n\t\t\t\t\tfor (var i = 0; i < old.length; i++) {\n\t\t\t\t\t\tif (old[i] === vnodes[i]) continue\n\t\t\t\t\t\telse if (old[i] == null && vnodes[i] != null) createNode(parent, vnodes[i], hooks, ns, getNextSibling(old, i + 1, nextSibling))\n\t\t\t\t\t\telse if (vnodes[i] == null) removeNodes(old, i, i + 1, vnodes)\n\t\t\t\t\t\telse updateNode(parent, old[i], vnodes[i], hooks, getNextSibling(old, i + 1, nextSibling), recycling, ns)\n\t\t\t\t\t}\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}\n\t\t\trecycling = recycling || isRecyclable(old, vnodes)\n\t\t\tif (recycling) {\n\t\t\t\tvar pool = old.pool\n\t\t\t\told = old.concat(old.pool)\n\t\t\t}\n\t\t\tvar oldStart = 0, start = 0, oldEnd = old.length - 1, end = vnodes.length - 1, map\n\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\tvar o = old[oldStart], v = vnodes[start]\n\t\t\t\tif (o === v && !recycling) oldStart++, start++\n\t\t\t\telse if (o == null) oldStart++\n\t\t\t\telse if (v == null) start++\n\t\t\t\telse if (o.key === v.key) {\n\t\t\t\t\tvar shouldRecycle = (pool != null && oldStart >= old.length - pool.length) || ((pool == null) && recycling)\n\t\t\t\t\toldStart++, start++\n\t\t\t\t\tupdateNode(parent, o, v, hooks, getNextSibling(old, oldStart, nextSibling), shouldRecycle, ns)\n\t\t\t\t\tif (recycling && o.tag === v.tag) insertNode(parent, toFragment(o), nextSibling)\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar o = old[oldEnd]\n\t\t\t\t\tif (o === v && !recycling) oldEnd--, start++\n\t\t\t\t\telse if (o == null) oldEnd--\n\t\t\t\t\telse if (v == null) start++\n\t\t\t\t\telse if (o.key === v.key) {\n\t\t\t\t\t\tvar shouldRecycle = (pool != null && oldEnd >= old.length - pool.length) || ((pool == null) && recycling)\n\t\t\t\t\t\tupdateNode(parent, o, v, hooks, getNextSibling(old, oldEnd + 1, nextSibling), shouldRecycle, ns)\n\t\t\t\t\t\tif (recycling || start < end) insertNode(parent, toFragment(o), getNextSibling(old, oldStart, nextSibling))\n\t\t\t\t\t\toldEnd--, start++\n\t\t\t\t\t}\n\t\t\t\t\telse break\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\tvar o = old[oldEnd], v = vnodes[end]\n\t\t\t\tif (o === v && !recycling) oldEnd--, end--\n\t\t\t\telse if (o == null) oldEnd--\n\t\t\t\telse if (v == null) end--\n\t\t\t\telse if (o.key === v.key) {\n\t\t\t\t\tvar shouldRecycle = (pool != null && oldEnd >= old.length - pool.length) || ((pool == null) && recycling)\n\t\t\t\t\tupdateNode(parent, o, v, hooks, getNextSibling(old, oldEnd + 1, nextSibling), shouldRecycle, ns)\n\t\t\t\t\tif (recycling && o.tag === v.tag) insertNode(parent, toFragment(o), nextSibling)\n\t\t\t\t\tif (o.dom != null) nextSibling = o.dom\n\t\t\t\t\toldEnd--, end--\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!map) map = getKeyMap(old, oldEnd)\n\t\t\t\t\tif (v != null) {\n\t\t\t\t\t\tvar oldIndex = map[v.key]\n\t\t\t\t\t\tif (oldIndex != null) {\n\t\t\t\t\t\t\tvar movable = old[oldIndex]\n\t\t\t\t\t\t\tvar shouldRecycle = (pool != null && oldIndex >= old.length - pool.length) || ((pool == null) && recycling)\n\t\t\t\t\t\t\tupdateNode(parent, movable, v, hooks, getNextSibling(old, oldEnd + 1, nextSibling), recycling, ns)\n\t\t\t\t\t\t\tinsertNode(parent, toFragment(movable), nextSibling)\n\t\t\t\t\t\t\told[oldIndex].skip = true\n\t\t\t\t\t\t\tif (movable.dom != null) nextSibling = movable.dom\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar dom = createNode(parent, v, hooks, ns, nextSibling)\n\t\t\t\t\t\t\tnextSibling = dom\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tend--\n\t\t\t\t}\n\t\t\t\tif (end < start) break\n\t\t\t}\n\t\t\tcreateNodes(parent, vnodes, start, end + 1, hooks, nextSibling, ns)\n\t\t\tremoveNodes(old, oldStart, oldEnd + 1, vnodes)\n\t\t}\n\t}\n\tfunction updateNode(parent, old, vnode, hooks, nextSibling, recycling, ns) {\n\t\tvar oldTag = old.tag, tag = vnode.tag\n\t\tif (oldTag === tag) {\n\t\t\tvnode.state = old.state\n\t\t\tvnode._state = old._state\n\t\t\tvnode.events = old.events\n\t\t\tif (!recycling && shouldNotUpdate(vnode, old)) return\n\t\t\tif (typeof oldTag === \"string\") {\n\t\t\t\tif (vnode.attrs != null) {\n\t\t\t\t\tif (recycling) {\n\t\t\t\t\t\tvnode.state = {}\n\t\t\t\t\t\tinitLifecycle(vnode.attrs, vnode, hooks)\n\t\t\t\t\t}\n\t\t\t\t\telse updateLifecycle(vnode.attrs, vnode, hooks)\n\t\t\t\t}\n\t\t\t\tswitch (oldTag) {\n\t\t\t\t\tcase \"#\": updateText(old, vnode); break\n\t\t\t\t\tcase \"<\": updateHTML(parent, old, vnode, nextSibling); break\n\t\t\t\t\tcase \"[\": updateFragment(parent, old, vnode, recycling, hooks, nextSibling, ns); break\n\t\t\t\t\tdefault: updateElement(old, vnode, recycling, hooks, ns)\n\t\t\t\t}\n\t\t\t}\n\t\t\telse updateComponent(parent, old, vnode, hooks, nextSibling, recycling, ns)\n\t\t}\n\t\telse {\n\t\t\tremoveNode(old, null)\n\t\t\tcreateNode(parent, vnode, hooks, ns, nextSibling)\n\t\t}\n\t}\n\tfunction updateText(old, vnode) {\n\t\tif (old.children.toString() !== vnode.children.toString()) {\n\t\t\told.dom.nodeValue = vnode.children\n\t\t}\n\t\tvnode.dom = old.dom\n\t}\n\tfunction updateHTML(parent, old, vnode, nextSibling) {\n\t\tif (old.children !== vnode.children) {\n\t\t\ttoFragment(old)\n\t\t\tcreateHTML(parent, vnode, nextSibling)\n\t\t}\n\t\telse vnode.dom = old.dom, vnode.domSize = old.domSize\n\t}\n\tfunction updateFragment(parent, old, vnode, recycling, hooks, nextSibling, ns) {\n\t\tupdateNodes(parent, old.children, vnode.children, recycling, hooks, nextSibling, ns)\n\t\tvar domSize = 0, children = vnode.children\n\t\tvnode.dom = null\n\t\tif (children != null) {\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tvar child = children[i]\n\t\t\t\tif (child != null && child.dom != null) {\n\t\t\t\t\tif (vnode.dom == null) vnode.dom = child.dom\n\t\t\t\t\tdomSize += child.domSize || 1\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (domSize !== 1) vnode.domSize = domSize\n\t\t}\n\t}\n\tfunction updateElement(old, vnode, recycling, hooks, ns) {\n\t\tvar element = vnode.dom = old.dom\n\t\tns = getNameSpace(vnode) || ns\n\t\tif (vnode.tag === \"textarea\") {\n\t\t\tif (vnode.attrs == null) vnode.attrs = {}\n\t\t\tif (vnode.text != null) {\n\t\t\t\tvnode.attrs.value = vnode.text //FIXME handle0 multiple children\n\t\t\t\tvnode.text = undefined\n\t\t\t}\n\t\t}\n\t\tupdateAttrs(vnode, old.attrs, vnode.attrs, ns)\n\t\tif (vnode.attrs != null && vnode.attrs.contenteditable != null) {\n\t\t\tsetContentEditable(vnode)\n\t\t}\n\t\telse if (old.text != null && vnode.text != null && vnode.text !== \"\") {\n\t\t\tif (old.text.toString() !== vnode.text.toString()) old.dom.firstChild.nodeValue = vnode.text\n\t\t}\n\t\telse {\n\t\t\tif (old.text != null) old.children = [Vnode(\"#\", undefined, undefined, old.text, undefined, old.dom.firstChild)]\n\t\t\tif (vnode.text != null) vnode.children = [Vnode(\"#\", undefined, undefined, vnode.text, undefined, undefined)]\n\t\t\tupdateNodes(element, old.children, vnode.children, recycling, hooks, null, ns)\n\t\t}\n\t}\n\tfunction updateComponent(parent, old, vnode, hooks, nextSibling, recycling, ns) {\n\t\tif (recycling) {\n\t\t\tinitComponent(vnode, hooks)\n\t\t} else {\n\t\t\tvnode.instance = Vnode.normalize(vnode._state.view.call(vnode.state, vnode))\n\t\t\tif (vnode.instance === vnode) throw Error(\"A view cannot return the vnode it received as argument\")\n\t\t\tif (vnode.attrs != null) updateLifecycle(vnode.attrs, vnode, hooks)\n\t\t\tupdateLifecycle(vnode._state, vnode, hooks)\n\t\t}\n\t\tif (vnode.instance != null) {\n\t\t\tif (old.instance == null) createNode(parent, vnode.instance, hooks, ns, nextSibling)\n\t\t\telse updateNode(parent, old.instance, vnode.instance, hooks, nextSibling, recycling, ns)\n\t\t\tvnode.dom = vnode.instance.dom\n\t\t\tvnode.domSize = vnode.instance.domSize\n\t\t}\n\t\telse if (old.instance != null) {\n\t\t\tremoveNode(old.instance, null)\n\t\t\tvnode.dom = undefined\n\t\t\tvnode.domSize = 0\n\t\t}\n\t\telse {\n\t\t\tvnode.dom = old.dom\n\t\t\tvnode.domSize = old.domSize\n\t\t}\n\t}\n\tfunction isRecyclable(old, vnodes) {\n\t\tif (old.pool != null && Math.abs(old.pool.length - vnodes.length) <= Math.abs(old.length - vnodes.length)) {\n\t\t\tvar oldChildrenLength = old[0] && old[0].children && old[0].children.length || 0\n\t\t\tvar poolChildrenLength = old.pool[0] && old.pool[0].children && old.pool[0].children.length || 0\n\t\t\tvar vnodesChildrenLength = vnodes[0] && vnodes[0].children && vnodes[0].children.length || 0\n\t\t\tif (Math.abs(poolChildrenLength - vnodesChildrenLength) <= Math.abs(oldChildrenLength - vnodesChildrenLength)) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\t\treturn false\n\t}\n\tfunction getKeyMap(vnodes, end) {\n\t\tvar map = {}, i = 0\n\t\tfor (var i = 0; i < end; i++) {\n\t\t\tvar vnode = vnodes[i]\n\t\t\tif (vnode != null) {\n\t\t\t\tvar key2 = vnode.key\n\t\t\t\tif (key2 != null) map[key2] = i\n\t\t\t}\n\t\t}\n\t\treturn map\n\t}\n\tfunction toFragment(vnode) {\n\t\tvar count0 = vnode.domSize\n\t\tif (count0 != null || vnode.dom == null) {\n\t\t\tvar fragment = $doc.createDocumentFragment()\n\t\t\tif (count0 > 0) {\n\t\t\t\tvar dom = vnode.dom\n\t\t\t\twhile (--count0) fragment.appendChild(dom.nextSibling)\n\t\t\t\tfragment.insertBefore(dom, fragment.firstChild)\n\t\t\t}\n\t\t\treturn fragment\n\t\t}\n\t\telse return vnode.dom\n\t}\n\tfunction getNextSibling(vnodes, i, nextSibling) {\n\t\tfor (; i < vnodes.length; i++) {\n\t\t\tif (vnodes[i] != null && vnodes[i].dom != null) return vnodes[i].dom\n\t\t}\n\t\treturn nextSibling\n\t}\n\tfunction insertNode(parent, dom, nextSibling) {\n\t\tif (nextSibling && nextSibling.parentNode) parent.insertBefore(dom, nextSibling)\n\t\telse parent.appendChild(dom)\n\t}\n\tfunction setContentEditable(vnode) {\n\t\tvar children = vnode.children\n\t\tif (children != null && children.length === 1 && children[0].tag === \"<\") {\n\t\t\tvar content = children[0].children\n\t\t\tif (vnode.dom.innerHTML !== content) vnode.dom.innerHTML = content\n\t\t}\n\t\telse if (vnode.text != null || children != null && children.length !== 0) throw new Error(\"Child node of a contenteditable must be trusted\")\n\t}\n\t//remove\n\tfunction removeNodes(vnodes, start, end, context) {\n\t\tfor (var i = start; i < end; i++) {\n\t\t\tvar vnode = vnodes[i]\n\t\t\tif (vnode != null) {\n\t\t\t\tif (vnode.skip) vnode.skip = false\n\t\t\t\telse removeNode(vnode, context)\n\t\t\t}\n\t\t}\n\t}\n\tfunction removeNode(vnode, context) {\n\t\tvar expected = 1, called = 0\n\t\tif (vnode.attrs && typeof vnode.attrs.onbeforeremove === \"function\") {\n\t\t\tvar result = vnode.attrs.onbeforeremove.call(vnode.state, vnode)\n\t\t\tif (result != null && typeof result.then === \"function\") {\n\t\t\t\texpected++\n\t\t\t\tresult.then(continuation, continuation)\n\t\t\t}\n\t\t}\n\t\tif (typeof vnode.tag !== \"string\" && typeof vnode._state.onbeforeremove === \"function\") {\n\t\t\tvar result = vnode._state.onbeforeremove.call(vnode.state, vnode)\n\t\t\tif (result != null && typeof result.then === \"function\") {\n\t\t\t\texpected++\n\t\t\t\tresult.then(continuation, continuation)\n\t\t\t}\n\t\t}\n\t\tcontinuation()\n\t\tfunction continuation() {\n\t\t\tif (++called === expected) {\n\t\t\t\tonremove(vnode)\n\t\t\t\tif (vnode.dom) {\n\t\t\t\t\tvar count0 = vnode.domSize || 1\n\t\t\t\t\tif (count0 > 1) {\n\t\t\t\t\t\tvar dom = vnode.dom\n\t\t\t\t\t\twhile (--count0) {\n\t\t\t\t\t\t\tremoveNodeFromDOM(dom.nextSibling)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tremoveNodeFromDOM(vnode.dom)\n\t\t\t\t\tif (context != null && vnode.domSize == null && !hasIntegrationMethods(vnode.attrs) && typeof vnode.tag === \"string\") { //TODO test custom elements\n\t\t\t\t\t\tif (!context.pool) context.pool = [vnode]\n\t\t\t\t\t\telse context.pool.push(vnode)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfunction removeNodeFromDOM(node) {\n\t\tvar parent = node.parentNode\n\t\tif (parent != null) parent.removeChild(node)\n\t}\n\tfunction onremove(vnode) {\n\t\tif (vnode.attrs && typeof vnode.attrs.onremove === \"function\") vnode.attrs.onremove.call(vnode.state, vnode)\n\t\tif (typeof vnode.tag !== \"string\") {\n\t\t\tif (typeof vnode._state.onremove === \"function\") vnode._state.onremove.call(vnode.state, vnode)\n\t\t\tif (vnode.instance != null) onremove(vnode.instance)\n\t\t} else {\n\t\t\tvar children = vnode.children\n\t\t\tif (Array.isArray(children)) {\n\t\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\t\tvar child = children[i]\n\t\t\t\t\tif (child != null) onremove(child)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t//attrs2\n\tfunction setAttrs(vnode, attrs2, ns) {\n\t\tfor (var key2 in attrs2) {\n\t\t\tsetAttr(vnode, key2, null, attrs2[key2], ns)\n\t\t}\n\t}\n\tfunction setAttr(vnode, key2, old, value, ns) {\n\t\tvar element = vnode.dom\n\t\tif (key2 === \"key\" || key2 === \"is\" || (old === value && !isFormAttribute(vnode, key2)) && typeof value !== \"object\" || typeof value === \"undefined\" || isLifecycleMethod(key2)) return\n\t\tvar nsLastIndex = key2.indexOf(\":\")\n\t\tif (nsLastIndex > -1 && key2.substr(0, nsLastIndex) === \"xlink\") {\n\t\t\telement.setAttributeNS(\"http://www.w3.org/1999/xlink\", key2.slice(nsLastIndex + 1), value)\n\t\t}\n\t\telse if (key2[0] === \"o\" && key2[1] === \"n\" && typeof value === \"function\") updateEvent(vnode, key2, value)\n\t\telse if (key2 === \"style\") updateStyle(element, old, value)\n\t\telse if (key2 in element && !isAttribute(key2) && ns === undefined && !isCustomElement(vnode)) {\n\t\t\tif (key2 === \"value\") {\n\t\t\t\tvar normalized0 = \"\" + value // eslint-disable-line no-implicit-coercion\n\t\t\t\t//setting input[value] to same value by typing on focused element moves cursor to end in Chrome\n\t\t\t\tif ((vnode.tag === \"input\" || vnode.tag === \"textarea\") && vnode.dom.value === normalized0 && vnode.dom === $doc.activeElement) return\n\t\t\t\t//setting select[value] to same value while having select open blinks select dropdown in Chrome\n\t\t\t\tif (vnode.tag === \"select\") {\n\t\t\t\t\tif (value === null) {\n\t\t\t\t\t\tif (vnode.dom.selectedIndex === -1 && vnode.dom === $doc.activeElement) return\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (old !== null && vnode.dom.value === normalized0 && vnode.dom === $doc.activeElement) return\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//setting option[value] to same value while having select open blinks select dropdown in Chrome\n\t\t\t\tif (vnode.tag === \"option\" && old != null && vnode.dom.value === normalized0) return\n\t\t\t}\n\t\t\t// If you assign an input type1 that is not supported by IE 11 with an assignment expression, an error0 will occur.\n\t\t\tif (vnode.tag === \"input\" && key2 === \"type\") {\n\t\t\t\telement.setAttribute(key2, value)\n\t\t\t\treturn\n\t\t\t}\n\t\t\telement[key2] = value\n\t\t}\n\t\telse {\n\t\t\tif (typeof value === \"boolean\") {\n\t\t\t\tif (value) element.setAttribute(key2, \"\")\n\t\t\t\telse element.removeAttribute(key2)\n\t\t\t}\n\t\t\telse element.setAttribute(key2 === \"className\" ? \"class\" : key2, value)\n\t\t}\n\t}\n\tfunction setLateAttrs(vnode) {\n\t\tvar attrs2 = vnode.attrs\n\t\tif (vnode.tag === \"select\" && attrs2 != null) {\n\t\t\tif (\"value\" in attrs2) setAttr(vnode, \"value\", null, attrs2.value, undefined)\n\t\t\tif (\"selectedIndex\" in attrs2) setAttr(vnode, \"selectedIndex\", null, attrs2.selectedIndex, undefined)\n\t\t}\n\t}\n\tfunction updateAttrs(vnode, old, attrs2, ns) {\n\t\tif (attrs2 != null) {\n\t\t\tfor (var key2 in attrs2) {\n\t\t\t\tsetAttr(vnode, key2, old && old[key2], attrs2[key2], ns)\n\t\t\t}\n\t\t}\n\t\tif (old != null) {\n\t\t\tfor (var key2 in old) {\n\t\t\t\tif (attrs2 == null || !(key2 in attrs2)) {\n\t\t\t\t\tif (key2 === \"className\") key2 = \"class\"\n\t\t\t\t\tif (key2[0] === \"o\" && key2[1] === \"n\" && !isLifecycleMethod(key2)) updateEvent(vnode, key2, undefined)\n\t\t\t\t\telse if (key2 !== \"key\") vnode.dom.removeAttribute(key2)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfunction isFormAttribute(vnode, attr) {\n\t\treturn attr === \"value\" || attr === \"checked\" || attr === \"selectedIndex\" || attr === \"selected\" && vnode.dom === $doc.activeElement\n\t}\n\tfunction isLifecycleMethod(attr) {\n\t\treturn attr === \"oninit\" || attr === \"oncreate\" || attr === \"onupdate\" || attr === \"onremove\" || attr === \"onbeforeremove\" || attr === \"onbeforeupdate\"\n\t}\n\tfunction isAttribute(attr) {\n\t\treturn attr === \"href\" || attr === \"list\" || attr === \"form\" || attr === \"width\" || attr === \"height\"// || attr === \"type\"\n\t}\n\tfunction isCustomElement(vnode){\n\t\treturn vnode.attrs.is || vnode.tag.indexOf(\"-\") > -1\n\t}\n\tfunction hasIntegrationMethods(source) {\n\t\treturn source != null && (source.oncreate || source.onupdate || source.onbeforeremove || source.onremove)\n\t}\n\t//style\n\tfunction updateStyle(element, old, style) {\n\t\tif (old === style) element.style.cssText = \"\", old = null\n\t\tif (style == null) element.style.cssText = \"\"\n\t\telse if (typeof style === \"string\") element.style.cssText = style\n\t\telse {\n\t\t\tif (typeof old === \"string\") element.style.cssText = \"\"\n\t\t\tfor (var key2 in style) {\n\t\t\t\telement.style[key2] = style[key2]\n\t\t\t}\n\t\t\tif (old != null && typeof old !== \"string\") {\n\t\t\t\tfor (var key2 in old) {\n\t\t\t\t\tif (!(key2 in style)) element.style[key2] = \"\"\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t//event\n\tfunction updateEvent(vnode, key2, value) {\n\t\tvar element = vnode.dom\n\t\tvar callback = typeof onevent !== \"function\" ? value : function(e) {\n\t\t\tvar result = value.call(element, e)\n\t\t\tonevent.call(element, e)\n\t\t\treturn result\n\t\t}\n\t\tif (key2 in element) element[key2] = typeof value === \"function\" ? callback : null\n\t\telse {\n\t\t\tvar eventName = key2.slice(2)\n\t\t\tif (vnode.events === undefined) vnode.events = {}\n\t\t\tif (vnode.events[key2] === callback) return\n\t\t\tif (vnode.events[key2] != null) element.removeEventListener(eventName, vnode.events[key2], false)\n\t\t\tif (typeof value === \"function\") {\n\t\t\t\tvnode.events[key2] = callback\n\t\t\t\telement.addEventListener(eventName, vnode.events[key2], false)\n\t\t\t}\n\t\t}\n\t}\n\t//lifecycle\n\tfunction initLifecycle(source, vnode, hooks) {\n\t\tif (typeof source.oninit === \"function\") source.oninit.call(vnode.state, vnode)\n\t\tif (typeof source.oncreate === \"function\") hooks.push(source.oncreate.bind(vnode.state, vnode))\n\t}\n\tfunction updateLifecycle(source, vnode, hooks) {\n\t\tif (typeof source.onupdate === \"function\") hooks.push(source.onupdate.bind(vnode.state, vnode))\n\t}\n\tfunction shouldNotUpdate(vnode, old) {\n\t\tvar forceVnodeUpdate, forceComponentUpdate\n\t\tif (vnode.attrs != null && typeof vnode.attrs.onbeforeupdate === \"function\") forceVnodeUpdate = vnode.attrs.onbeforeupdate.call(vnode.state, vnode, old)\n\t\tif (typeof vnode.tag !== \"string\" && typeof vnode._state.onbeforeupdate === \"function\") forceComponentUpdate = vnode._state.onbeforeupdate.call(vnode.state, vnode, old)\n\t\tif (!(forceVnodeUpdate === undefined && forceComponentUpdate === undefined) && !forceVnodeUpdate && !forceComponentUpdate) {\n\t\t\tvnode.dom = old.dom\n\t\t\tvnode.domSize = old.domSize\n\t\t\tvnode.instance = old.instance\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t}\n\tfunction render(dom, vnodes) {\n\t\tif (!dom) throw new Error(\"Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.\")\n\t\tvar hooks = []\n\t\tvar active = $doc.activeElement\n\t\tvar namespace = dom.namespaceURI\n\t\t// First time0 rendering into a node clears it out\n\t\tif (dom.vnodes == null) dom.textContent = \"\"\n\t\tif (!Array.isArray(vnodes)) vnodes = [vnodes]\n\t\tupdateNodes(dom, dom.vnodes, Vnode.normalizeChildren(vnodes), false, hooks, null, namespace === \"http://www.w3.org/1999/xhtml\" ? undefined : namespace)\n\t\tdom.vnodes = vnodes\n\t\t// document.activeElement can return null in IE https://developer.mozilla.org/en-US/docs/Web/API/Document/activeElement\n\t\tif (active != null && $doc.activeElement !== active) active.focus()\n\t\tfor (var i = 0; i < hooks.length; i++) hooks[i]()\n\t}\n\treturn {render: render, setEventCallback: setEventCallback}\n}\nfunction throttle(callback) {\n\t//60fps translates to 16.6ms, round it down since setTimeout requires int\n\tvar time = 16\n\tvar last = 0, pending = null\n\tvar timeout = typeof requestAnimationFrame === \"function\" ? requestAnimationFrame : setTimeout\n\treturn function() {\n\t\tvar now = Date.now()\n\t\tif (last === 0 || now - last >= time) {\n\t\t\tlast = now\n\t\t\tcallback()\n\t\t}\n\t\telse if (pending === null) {\n\t\t\tpending = timeout(function() {\n\t\t\t\tpending = null\n\t\t\t\tcallback()\n\t\t\t\tlast = Date.now()\n\t\t\t}, time - (now - last))\n\t\t}\n\t}\n}\nvar _11 = function($window) {\n\tvar renderService = coreRenderer($window)\n\trenderService.setEventCallback(function(e) {\n\t\tif (e.redraw === false) e.redraw = undefined\n\t\telse redraw()\n\t})\n\tvar callbacks = []\n\tfunction subscribe(key1, callback) {\n\t\tunsubscribe(key1)\n\t\tcallbacks.push(key1, throttle(callback))\n\t}\n\tfunction unsubscribe(key1) {\n\t\tvar index = callbacks.indexOf(key1)\n\t\tif (index > -1) callbacks.splice(index, 2)\n\t}\n\tfunction redraw() {\n\t\tfor (var i = 1; i < callbacks.length; i += 2) {\n\t\t\tcallbacks[i]()\n\t\t}\n\t}\n\treturn {subscribe: subscribe, unsubscribe: unsubscribe, redraw: redraw, render: renderService.render}\n}\nvar redrawService = _11(window)\nrequestService.setCompletionCallback(redrawService.redraw)\nvar _16 = function(redrawService0) {\n\treturn function(root, component) {\n\t\tif (component === null) {\n\t\t\tredrawService0.render(root, [])\n\t\t\tredrawService0.unsubscribe(root)\n\t\t\treturn\n\t\t}\n\t\t\n\t\tif (component.view == null && typeof component !== \"function\") throw new Error(\"m.mount(element, component) expects a component, not a vnode\")\n\t\t\n\t\tvar run0 = function() {\n\t\t\tredrawService0.render(root, Vnode(component))\n\t\t}\n\t\tredrawService0.subscribe(root, run0)\n\t\tredrawService0.redraw()\n\t}\n}\nm.mount = _16(redrawService)\nvar Promise = PromisePolyfill\nvar parseQueryString = function(string) {\n\tif (string === \"\" || string == null) return {}\n\tif (string.charAt(0) === \"?\") string = string.slice(1)\n\tvar entries = string.split(\"&\"), data0 = {}, counters = {}\n\tfor (var i = 0; i < entries.length; i++) {\n\t\tvar entry = entries[i].split(\"=\")\n\t\tvar key5 = decodeURIComponent(entry[0])\n\t\tvar value = entry.length === 2 ? decodeURIComponent(entry[1]) : \"\"\n\t\tif (value === \"true\") value = true\n\t\telse if (value === \"false\") value = false\n\t\tvar levels = key5.split(/\\]\\[?|\\[/)\n\t\tvar cursor = data0\n\t\tif (key5.indexOf(\"[\") > -1) levels.pop()\n\t\tfor (var j = 0; j < levels.length; j++) {\n\t\t\tvar level = levels[j], nextLevel = levels[j + 1]\n\t\t\tvar isNumber = nextLevel == \"\" || !isNaN(parseInt(nextLevel, 10))\n\t\t\tvar isValue = j === levels.length - 1\n\t\t\tif (level === \"\") {\n\t\t\t\tvar key5 = levels.slice(0, j).join()\n\t\t\t\tif (counters[key5] == null) counters[key5] = 0\n\t\t\t\tlevel = counters[key5]++\n\t\t\t}\n\t\t\tif (cursor[level] == null) {\n\t\t\t\tcursor[level] = isValue ? value : isNumber ? [] : {}\n\t\t\t}\n\t\t\tcursor = cursor[level]\n\t\t}\n\t}\n\treturn data0\n}\nvar coreRouter = function($window) {\n\tvar supportsPushState = typeof $window.history.pushState === \"function\"\n\tvar callAsync0 = typeof setImmediate === \"function\" ? setImmediate : setTimeout\n\tfunction normalize1(fragment0) {\n\t\tvar data = $window.location[fragment0].replace(/(?:%[a-f89][a-f0-9])+/gim, decodeURIComponent)\n\t\tif (fragment0 === \"pathname\" && data[0] !== \"/\") data = \"/\" + data\n\t\treturn data\n\t}\n\tvar asyncId\n\tfunction debounceAsync(callback0) {\n\t\treturn function() {\n\t\t\tif (asyncId != null) return\n\t\t\tasyncId = callAsync0(function() {\n\t\t\t\tasyncId = null\n\t\t\t\tcallback0()\n\t\t\t})\n\t\t}\n\t}\n\tfunction parsePath(path, queryData, hashData) {\n\t\tvar queryIndex = path.indexOf(\"?\")\n\t\tvar hashIndex = path.indexOf(\"#\")\n\t\tvar pathEnd = queryIndex > -1 ? queryIndex : hashIndex > -1 ? hashIndex : path.length\n\t\tif (queryIndex > -1) {\n\t\t\tvar queryEnd = hashIndex > -1 ? hashIndex : path.length\n\t\t\tvar queryParams = parseQueryString(path.slice(queryIndex + 1, queryEnd))\n\t\t\tfor (var key4 in queryParams) queryData[key4] = queryParams[key4]\n\t\t}\n\t\tif (hashIndex > -1) {\n\t\t\tvar hashParams = parseQueryString(path.slice(hashIndex + 1))\n\t\t\tfor (var key4 in hashParams) hashData[key4] = hashParams[key4]\n\t\t}\n\t\treturn path.slice(0, pathEnd)\n\t}\n\tvar router = {prefix: \"#!\"}\n\trouter.getPath = function() {\n\t\tvar type2 = router.prefix.charAt(0)\n\t\tswitch (type2) {\n\t\t\tcase \"#\": return normalize1(\"hash\").slice(router.prefix.length)\n\t\t\tcase \"?\": return normalize1(\"search\").slice(router.prefix.length) + normalize1(\"hash\")\n\t\t\tdefault: return normalize1(\"pathname\").slice(router.prefix.length) + normalize1(\"search\") + normalize1(\"hash\")\n\t\t}\n\t}\n\trouter.setPath = function(path, data, options) {\n\t\tvar queryData = {}, hashData = {}\n\t\tpath = parsePath(path, queryData, hashData)\n\t\tif (data != null) {\n\t\t\tfor (var key4 in data) queryData[key4] = data[key4]\n\t\t\tpath = path.replace(/:([^\\/]+)/g, function(match2, token) {\n\t\t\t\tdelete queryData[token]\n\t\t\t\treturn data[token]\n\t\t\t})\n\t\t}\n\t\tvar query = buildQueryString(queryData)\n\t\tif (query) path += \"?\" + query\n\t\tvar hash = buildQueryString(hashData)\n\t\tif (hash) path += \"#\" + hash\n\t\tif (supportsPushState) {\n\t\t\tvar state = options ? options.state : null\n\t\t\tvar title = options ? options.title : null\n\t\t\t$window.onpopstate()\n\t\t\tif (options && options.replace) $window.history.replaceState(state, title, router.prefix + path)\n\t\t\telse $window.history.pushState(state, title, router.prefix + path)\n\t\t}\n\t\telse $window.location.href = router.prefix + path\n\t}\n\trouter.defineRoutes = function(routes, resolve, reject) {\n\t\tfunction resolveRoute() {\n\t\t\tvar path = router.getPath()\n\t\t\tvar params = {}\n\t\t\tvar pathname = parsePath(path, params, params)\n\t\t\tvar state = $window.history.state\n\t\t\tif (state != null) {\n\t\t\t\tfor (var k in state) params[k] = state[k]\n\t\t\t}\n\t\t\tfor (var route0 in routes) {\n\t\t\t\tvar matcher = new RegExp(\"^\" + route0.replace(/:[^\\/]+?\\.{3}/g, \"(.*?)\").replace(/:[^\\/]+/g, \"([^\\\\/]+)\") + \"\\/?$\")\n\t\t\t\tif (matcher.test(pathname)) {\n\t\t\t\t\tpathname.replace(matcher, function() {\n\t\t\t\t\t\tvar keys = route0.match(/:[^\\/]+/g) || []\n\t\t\t\t\t\tvar values = [].slice.call(arguments, 1, -2)\n\t\t\t\t\t\tfor (var i = 0; i < keys.length; i++) {\n\t\t\t\t\t\t\tparams[keys[i].replace(/:|\\./g, \"\")] = decodeURIComponent(values[i])\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(routes[route0], params, path, route0)\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}\n\t\t\treject(path, params)\n\t\t}\n\t\tif (supportsPushState) $window.onpopstate = debounceAsync(resolveRoute)\n\t\telse if (router.prefix.charAt(0) === \"#\") $window.onhashchange = resolveRoute\n\t\tresolveRoute()\n\t}\n\treturn router\n}\nvar _20 = function($window, redrawService0) {\n\tvar routeService = coreRouter($window)\n\tvar identity = function(v) {return v}\n\tvar render1, component, attrs3, currentPath, lastUpdate\n\tvar route = function(root, defaultRoute, routes) {\n\t\tif (root == null) throw new Error(\"Ensure the DOM element that was passed to `m.route` is not undefined\")\n\t\tvar run1 = function() {\n\t\t\tif (render1 != null) redrawService0.render(root, render1(Vnode(component, attrs3.key, attrs3)))\n\t\t}\n\t\tvar bail = function(path) {\n\t\t\tif (path !== defaultRoute) routeService.setPath(defaultRoute, null, {replace: true})\n\t\t\telse throw new Error(\"Could not resolve default route \" + defaultRoute)\n\t\t}\n\t\trouteService.defineRoutes(routes, function(payload, params, path) {\n\t\t\tvar update = lastUpdate = function(routeResolver, comp) {\n\t\t\t\tif (update !== lastUpdate) return\n\t\t\t\tcomponent = comp != null && (typeof comp.view === \"function\" || typeof comp === \"function\")? comp : \"div\"\n\t\t\t\tattrs3 = params, currentPath = path, lastUpdate = null\n\t\t\t\trender1 = (routeResolver.render || identity).bind(routeResolver)\n\t\t\t\trun1()\n\t\t\t}\n\t\t\tif (payload.view || typeof payload === \"function\") update({}, payload)\n\t\t\telse {\n\t\t\t\tif (payload.onmatch) {\n\t\t\t\t\tPromise.resolve(payload.onmatch(params, path)).then(function(resolved) {\n\t\t\t\t\t\tupdate(payload, resolved)\n\t\t\t\t\t}, bail)\n\t\t\t\t}\n\t\t\t\telse update(payload, \"div\")\n\t\t\t}\n\t\t}, bail)\n\t\tredrawService0.subscribe(root, run1)\n\t}\n\troute.set = function(path, data, options) {\n\t\tif (lastUpdate != null) {\n\t\t\toptions = options || {}\n\t\t\toptions.replace = true\n\t\t}\n\t\tlastUpdate = null\n\t\trouteService.setPath(path, data, options)\n\t}\n\troute.get = function() {return currentPath}\n\troute.prefix = function(prefix0) {routeService.prefix = prefix0}\n\troute.link = function(vnode1) {\n\t\tvnode1.dom.setAttribute(\"href\", routeService.prefix + vnode1.attrs.href)\n\t\tvnode1.dom.onclick = function(e) {\n\t\t\tif (e.ctrlKey || e.metaKey || e.shiftKey || e.which === 2) return\n\t\t\te.preventDefault()\n\t\t\te.redraw = false\n\t\t\tvar href = this.getAttribute(\"href\")\n\t\t\tif (href.indexOf(routeService.prefix) === 0) href = href.slice(routeService.prefix.length)\n\t\t\troute.set(href, undefined, undefined)\n\t\t}\n\t}\n\troute.param = function(key3) {\n\t\tif(typeof attrs3 !== \"undefined\" && typeof key3 !== \"undefined\") return attrs3[key3]\n\t\treturn attrs3\n\t}\n\treturn route\n}\nm.route = _20(window, redrawService)\nm.withAttr = function(attrName, callback1, context) {\n\treturn function(e) {\n\t\tcallback1.call(context || this, attrName in e.currentTarget ? e.currentTarget[attrName] : e.currentTarget.getAttribute(attrName))\n\t}\n}\nvar _28 = coreRenderer(window)\nm.render = _28.render\nm.redraw = redrawService.redraw\nm.request = requestService.request\nm.jsonp = requestService.jsonp\nm.parseQueryString = parseQueryString\nm.buildQueryString = buildQueryString\nm.version = \"1.1.6\"\nm.vnode = Vnode\nif (typeof module !== \"undefined\") module[\"exports\"] = m\nelse window.m = m\n}());","export default function symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n","/* global window */\nimport ponyfill from './ponyfill.js';\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = ponyfill(root);\nexport default result;\n","import $$observable from 'symbol-observable';\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\n/**\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [preloadedState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error('It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error('You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected the listener to be a function.');\n    }\n\n    if (isDispatching) {\n      throw new Error('You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error('You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing what changed. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer;\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new TypeError('Expected the observer to be an object.');\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionDescription = actionType && \"action \\\"\" + String(actionType) + \"\\\"\" || 'an action';\n  return \"Given \" + actionDescription + \", reducer \\\"\" + key + \"\\\" returned undefined. \" + \"To ignore an action, you must explicitly return the previous state. \" + \"If you want this reducer to hold no value, you can return null instead of undefined.\";\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return \"The \" + argumentName + \" has unexpected type of \\\"\" + {}.toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + \"\\\". Expected argument to be an object with the following \" + (\"keys: \\\"\" + reducerKeys.join('\", \"') + \"\\\"\");\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n  if (action && action.type === ActionTypes.REPLACE) return;\n\n  if (unexpectedKeys.length > 0) {\n    return \"Unexpected \" + (unexpectedKeys.length > 1 ? 'keys' : 'key') + \" \" + (\"\\\"\" + unexpectedKeys.join('\", \"') + \"\\\" found in \" + argumentName + \". \") + \"Expected to find one of the known reducer keys instead: \" + (\"\\\"\" + reducerKeys.join('\", \"') + \"\\\". Unexpected keys will be ignored.\");\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, {\n      type: ActionTypes.INIT\n    });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error(\"Reducer \\\"\" + key + \"\\\" returned undefined during initialization. \" + \"If the state passed to the reducer is undefined, you must \" + \"explicitly return the initial state. The initial state may \" + \"not be undefined. If you don't want to set a value for this reducer, \" + \"you can use null instead of undefined.\");\n    }\n\n    if (typeof reducer(undefined, {\n      type: ActionTypes.PROBE_UNKNOWN_ACTION()\n    }) === 'undefined') {\n      throw new Error(\"Reducer \\\"\" + key + \"\\\" returned undefined when probed with a random type. \" + (\"Don't try to handle \" + ActionTypes.INIT + \" or other actions in \\\"redux/*\\\" \") + \"namespace. They are considered private. Instead, you must return the \" + \"current state for any unknown actions, unless it is undefined, \" + \"in which case you must return the initial state, regardless of the \" + \"action type. The initial state may not be undefined, but can be null.\");\n    }\n  });\n}\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\n\n\nfunction combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning(\"No reducer provided for key \\\"\" + key + \"\\\"\");\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n\n  var finalReducerKeys = Object.keys(finalReducers);\n  var unexpectedKeyCache;\n\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError;\n\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination(state, action) {\n    if (state === void 0) {\n      state = {};\n    }\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(_key, action);\n        throw new Error(errorMessage);\n      }\n\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n\n    return hasChanged ? nextState : state;\n  };\n}\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(this, arguments));\n  };\n}\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass a single function as the first argument,\n * and get a function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\n\n\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error(\"bindActionCreators expected an object or a function, instead received \" + (actionCreators === null ? 'null' : typeof actionCreators) + \". \" + \"Did you write \\\"import ActionCreators from\\\" instead of \\\"import * as ActionCreators from\\\"?\");\n  }\n\n  var keys = Object.keys(actionCreators);\n  var boundActionCreators = {};\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var actionCreator = actionCreators[key];\n\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n\n  return boundActionCreators;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\n/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\nfunction compose() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(void 0, arguments));\n    };\n  });\n}\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\n\nfunction applyMiddleware() {\n  for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function () {\n      var store = createStore.apply(void 0, arguments);\n\n      var _dispatch = function dispatch() {\n        throw new Error(\"Dispatching while constructing your middleware is not allowed. \" + \"Other middleware would not be applied to this dispatch.\");\n      };\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch() {\n          return _dispatch.apply(void 0, arguments);\n        }\n      };\n      var chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(void 0, chain)(store.dispatch);\n      return _objectSpread({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \"production\". ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexport { createStore, combineReducers, bindActionCreators, applyMiddleware, compose, ActionTypes as __DO_NOT_USE__ActionTypes };\n","import mlib from '../../../src';\nimport m from 'mithril';\n// import Redux from 'redux';\n\nconst {Router, r} = mlib.Router;\nconst Redux = require('redux');\n\n// var script = document.createElement('script');\n// script.src = \"https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.1/redux.js\";\n// document.getElementsByTagName('head')[0].appendChild(script);\n\n\n// R.go('/users/dane');\n\n\nfunction counter(state, action) {\n  if (typeof state === 'undefined') {\n    return 0\n  }\n  switch (action.type) {\n    case 'INCREMENT':\n      return state + 1\n    case 'DECREMENT':\n      return state - 1\n    default:\n      return state\n  }\n}\n\nvar store = Redux.createStore(counter)\n\nvar Link = {\n  view: ({attrs: {to, onclick, ...attrs }, children}) => m('a', {\n    ...attrs,\n    href: to,\n    onclick: (e) => {\n      onclick && onclick(e);\n      e.preventDefault();\n      R.match(to);\n    }\n  }, children)\n}\nconst users = {\n  dane: \"Dane\",\n  nom: 'Naumche'\n}\n\nconst sayHi = (key) => m(Link, {to: `/users/${key}`}, `Say hi to ${users[key]}!`);\n\nvar Template = {\n  view: (vnode) => m('div#app', vnode.children)\n};\nconst UserList = {\n  view: () => m('nav', [\n    sayHi('dane'),\n    sayHi('nom')\n  ])\n}\nconst NotFound = {\n  view: () => m('div', [\n    m('p', 'Not found!!!!!!!'),\n    m(UserList)\n  ])\n}\nconst Hello = {\n  view: (vnode) => m('div', [\n    m('p', `Hello, ${users[vnode.attrs.params.id]}!!!`),\n    m(UserList)\n  ])\n}\nvar Counter = {\n  view: (vnode) => m(\n    'nav', [\n      m('span#value', `${vnode.attrs.counter} times`),\n      m('button#inc', {\n        onclick: () => store.dispatch({ type: 'INCREMENT' })\n      }, '+'),\n      m('button#dec', {\n        onclick: () => store.dispatch({ type: 'DECREMENT' })\n      }, '-'),\n      m(UserList)\n    ]\n  )\n}\n\nconst root = [\n  r('/users', {\n    // resolve: ($) => !isUserLogged() ? $.redirect('/login') : $.continue(), // next(), return()\n    onmatch: () => new Promise(\n      (res, rej) => {\n        setTimeout(res, 500)\n      }\n    )\n  }, [\n    r('/', Counter),\n    r('/:id', Hello),\n    r('/:id/:filter', Hello),\n    r('/:userId', [\n      r('/posts/:postId', Hello),\n      r('/photos/:imageId', Hello)\n    ])\n  ])\n];\n// var App = {\n//   view: m(Router)\n// }\nconst App = () => {\n  const { component, params } = R.getRoute();\n  const state = store.getState();\n  console.log({ component, params, state })\n  return m(\n    Template,\n    m(component, {\n      params,\n      counter: state\n    })\n  );\n};\n\n\nfunction render() {\n  m.render( document.body, App() );\n}\n\nconst R = Router(root, NotFound);\nR.subscribe(render);\nstore.subscribe(render);\nrender();\n"]}